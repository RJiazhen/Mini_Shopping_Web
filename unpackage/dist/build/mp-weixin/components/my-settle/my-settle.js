"use strict";const t=require("../../common/vendor.js"),e={name:"my-settle",data:()=>({seconds:3,timer:null}),computed:{...t.mapGetters("m_cart",["checkedCount","total","checkedGoodsAmount"]),...t.mapGetters("m_user",["addStr"]),...t.mapState("m_user",["token"]),...t.mapState("m_cart",["cart"]),isFullCheck(){return this.checkedCount===this.total}},methods:{...t.mapMutations("m_cart",["updateAllGoodsState"]),...t.mapMutations("m_user",["updataRedirectInfo"]),changeAllState(){this.updateAllGoodsState(!this.isFullCheck)},settlement(){return this.checkedCount?this.addStr?this.token?void this.payOrder():this.deleyNavigate():t.index.$showMsg("请选择收货地址"):t.index.$showMsg("请选择要结算的商品")},showTips(e){t.index.showToast({icon:"none",title:"请先登录，将在"+e+"秒后跳转到登录页面",mask:!0})},deleyNavigate(){this.seconds=3,this.showTips(this.seconds),this.timer=setInterval((()=>{if(this.seconds--,this.seconds<=0)return clearInterval(this.timer),void t.index.switchTab({url:"/pages/my/my",success:()=>{this.updataRedirectInfo({openType:"switchTab",from:"/pages/cart/cart"})}});this.showTips(this.seconds)}),1e3)},async payOrder(){const e={order_price:.01,consignee_addrr:this.addStr,goods:this.cart.filter((t=>t.goods_state)).map((t=>({goods_id:t.goods_id,goods_number:t.goods_count,goods_price:t.goods_price})))};await t.index.$http.post("/api/public/v1/my/orders/create",e);const{data:s}=await t.index.$http.post("/api/public/v1/my/orders/req_unifiedorder",{order_number:2384923173239});console.log("res2",s)}}};const s=t._export_sfc(e,[["render",function(e,s,o,a,i,r){return{a:r.isFullCheck,b:t.o(((...t)=>r.changeAllState&&r.changeAllState(...t))),c:t.t(e.checkedGoodsAmount),d:t.t(e.checkedCount),e:t.o(((...t)=>r.settlement&&r.settlement(...t)))}}]]);wx.createComponent(s);
