"use strict";const e=require("../../common/vendor.js"),s={data:()=>({timer:null,keywrod:"",searchResult:[],searchHistory:[]}),computed:{historys(){return[...this.searchHistory].reverse()}},onLoad(){this.searchHistory=JSON.parse(e.index.getStorageSync("searchHistory")||"[]")},methods:{input(e){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.keywrod=e,this.getSearchResult()}),500)},async getSearchResult(){if(0===this.keywrod.length)return void(this.searchResult=[]);const{data:s}=await this.$http.get("/api/public/v1/goods/qsearch",{query:this.keywrod});if(200!==s.meta.status)return e.index.$showMsg();this.searchResult=s.message,this.saveSearchHistory()},gotoDetail(s){e.index.navigateTo({url:"/subpkg/goods_detail/goods_detail?goods_id="+s.goods_id})},saveSearchHistory(){const s=new Set(this.searchHistory);s.delete(this.keywrod),s.add(this.keywrod),this.searchHistory=Array.from(s),e.index.setStorageSync("searchHistory",JSON.stringify(this.searchHistory))},cleanSearchHistory(){this.searchHistory=[],e.index.setStorageSync("searchHistory","[]")},gotoGoodsList(s){e.index.navigateTo({url:"/subpkg/goods_list/goods_list?query="+s})}}};if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-tag"))()}Math||((()=>"../../uni_modules/uni-search-bar/components/uni-search-bar/uni-search-bar.js")+(()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../uni_modules/uni-tag/components/uni-tag/uni-tag.js"))();const t=e._export_sfc(s,[["render",function(s,t,o,r,i,a){return e.e({a:e.o(a.input),b:e.p({radius:100,cancelButton:"none"}),c:0!==i.searchResult.length},0!==i.searchResult.length?{d:e.f(i.searchResult,((s,t,o)=>({a:e.t(s.goods_name),b:"172e78ce-1-"+o,c:t,d:e.o((e=>a.gotoDetail(s)),t)}))),e:e.p({type:"arrowright",size:"16"})}:{f:e.o(a.cleanSearchHistory),g:e.p({type:"trash",size:"25"}),h:e.f(a.historys,((s,t,o)=>({a:t,b:e.o((e=>a.gotoGoodsList(s)),t),c:"172e78ce-3-"+o,d:e.p({text:s})})))})}]]);wx.createPage(t);
